@page "/editmovie"
@using Models
@inject NavigationManager NavigationManager

<PageTitle>Add Movie</PageTitle>

<h3>Add Movie</h3>

<EditForm Model="@_movie" FormName="editMovie" OnSubmit="HandleSubmit">
    <form>
        <div class="mb-3">
            <label for="nimi" class="form-label">Nimi</label>
            <InputText id="nimi" @bind-Value="_movie.Nimi" class="form-control" />
        </div>

        <div class="mb-3">
            <label for="ohjaaja" class="form-label">Ohjaaja</label>
            <InputText id="ohjaaja" @bind-Value="_movie.Ohjaaja" class="form-control" />
        </div>

        <div class="mb-3">
            <label for="julkaistu" class="form-label">Julkaistu</label>
            <InputNumber id="julkaistu" @bind-Value="_movie.Julkaistu" class="form-control" />
        </div>

        <div class="mb-3">
            <label for="length" class="form-label">Pituus</label>
            <InputNumber id="pituus" @bind-Value="_movie.Pituus" class="form-control" />
            <div class="form-text">Pituus minutes</div>
        </div>

        <div class="mb-3">
            <label for="rating" class="form-label">Arvio</label>
            <InputNumber id="arvio" @bind-Value="_movie.Arvio" class="form-control" />
            <div class="form-text">Arvio IMDB</div>
        </div>

        <div class="mb-3">
            <label for="genre" class="form-label">Genre</label>
            <InputText id="genre" @bind-Value="_movie.Genre" class="form-control" />
            <div class="form-text">Movie's genre</div>
        </div>
        <div class="mb-3">
            <label for="päänäyttelijät" class="form-label">Päänäyttelijät</label>
            <InputText id="päänäyttelijät" @bind-Value="_movie.Päänäyttelijät" class="form-control" />
            <div class="form-text">Movie's genre</div>
        </div>


        <button type="submit" class="btn btn-primary">Submit</button>
    </form>
</EditForm>

@code {
    [SupplyParameterFromForm]
    private Movie _movie { get; set; } = new(string.Empty);

    private Database _database = new Database();

    private void HandleSubmit()
    {
        // Varmistetaan että string on oikea asia ja saman nimistä elokuvaa ei ole jo olemassa
        if (_movie.Nimi != string.Empty && _database.CheckMovies(_movie) == false)
        { 
            _database.InsertMovie(_movie);
        }
        NavigationManager.NavigateTo("/movies");
    }
}
